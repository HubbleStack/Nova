stat:
  grub_conf_own:
    data:
      'CentOS-6':
        - '/etc/grub.conf':
            tag: 'CIS-1.5.1'
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/grub2/grub.cfg':
            tag: 'CIS-1.5.1'
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: 'Grub must be owned by root'
    alert: email
    trigger: state

  grub_conf_perm:
    data:
      'CentOS-6':
        - '/etc/grub.conf':
            tag: 'CIS-1.5.2'
            mode: 600
      'CentOS Linux-7':
        - '/etc/grub2/grub.cfg':
            tag: 'CIS-1.5.2'
            mode: 600
    description: 'Grub must have permissions 600'
    alert: email
    trigger: state

  hosts_allow:
    data:
      'CentOS-6':
        - '/etc/hosts.allow':
            tag: 'CIS-4.5.3'
            mode: 644
      'CentOS Linux-7':
        - '/etc/hosts.allow':
            tag: 'CIS-4.5.3'
            mode: 644
    description: '/etc/hosts.allow must have permissions 644'
    alert: email
    trigger: state

  hosts_deny:
    data:
      'CentOS-6':
        - '/etc/hosts.deny':
            tag: 'CIS-4.5.5'
            mode: 644
      'CentOS Linux-7':
        - '/etc/hosts.deny':
            tag: 'CIS-4.5.5'
            mode: 644
    description: '/etc/hosts.deny must have persmissions 644'
    alert: email
    trigger: state

  anacrontab:
    data:
      'CentOS-6':
        - '/etc/anacrontab':
            tag: 'CIS-6.1.3'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/anacrontab':
            tag: 'CIS-6.1.3'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/anacrontab file be owned by root and must have permissions 600'
    alert: email
    trigger: state

  crontab:
    data:
      'CentOS-6':
        - '/etc/crontab':
            tag: 'CIS-6.1.4'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/crontab':
            tag: 'CIS-6.1.4'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/crontab must be owned by root and have persmissions 600'
    alert: email
    trigger: state

  cron_hourly:
    data:
      'CentOS-6':
        - 'etc/cron.hourly':
            tag: 'CIS-6.1.5'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - 'etc/cron.hourly':
            tag: 'CIS-6.1.5'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/cron.hourly must be owned by root and must have permissions 700'
    alert: email
    trigger: state

  cron_daily:
    data:
      'CentOS-6':
        - '/etc/cron.daily':
            tag: 'CIS-6.1.6'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/cron.daily':
            tag: 'CIS-6.1.6'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/cron.daily must be owned by root and must have permissions 700'
    alert: email
    trigger: state

  cron_weekly:
    data:
      'CentOS-6':
        - '/etc/cron.weekly':
            tag: 'CIS-6.1.7'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/cron.weekly':
            tag: 'CIS-6.1.7'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/cron.weekly must be owned by root and must have permissions 700'
    alert: email
    trigger: state

  cron_monthly:
    data:
      'CentOS-6':
        - '/etc/cron.monthly':
            tag: 'CIS-6.1.8'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/cron.monthly':
            tag: 'CIS-6.1.8'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/cron.monthly must be owned by root and must have permissions 700'
    alert: email
    trigger: state

  cron_d:
    data:
      'CentOS-6':
        - '/etc/cron.d':
            tag: 'CIS-6.1.9'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/cron.d':
            tag: 'CIS-6.1.9'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/cron.d must be owned by root and must have permissions 700'
    alert: email
    trigger: state

  at_allow:
    data:
      'CentOS-6':
        - '/etc/at.allow':
            tag: 'CIS-6.1.10'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/at.allow':
            tag: 'CIS-6.1.10'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/at.allow must be owned by root and have persmissions 600'
    alert: email
    trigger: state

  at_cron_allow:
    data:
      'CentOS-6':
        - '/etc/cron.deny':
            tag: 'CIS-6.1.11'
            mode: null
            user: null
            uid: null
            group: null
            gid: null
        - '/etc/at.deny':
            tag: 'CIS-6.1.11'
            mode: null
            user: null
            uid: null
            group: null
            gid: null
        - '/etc/cron.allow':
            tag: 'CIS-6.1.11'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
        - '/etc/at/allow':
            tag: 'CIS-6.1.11'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/cron.deny':
            tag: 'CIS-6.1.11'
            mode: null
            user: null
            uid: null
            group: null
            gid: null
        - '/etc/at.deny':
            tag: 'CIS-6.1.11'
            mode: null
            user: null
            uid: null
            group: null
            gid: null
        - '/etc/cron.allow':
            tag: 'CIS-6.1.11'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
        - '/etc/at/allow':
            tag: 'CIS-6.1.11'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: 'Restrict at/cron to authorized users'
    alert: email
    trigger: state

  sshd_config:
    data:
      'CentOS-6':
        - '/etc/ssh/sshd_config':
            tag: 'CIS-6.2.3'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/ssh/sshd_config':
            tag: 'CIS-6.2.3'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/ssh/sshd_config must be owned by root and must have permissions 600'
    alert: email
    trigger: state

  warning_banner:
    data:
      'CentOS-6':
        - '/etc/motd':
            tag: 'CIS-8.1'
            mode: 644
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
        - '/etc/issue':
            tag: 'CIS-8.1'
            mode: 644
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
        - '/etc/issue.net':
            tag: 'CIS-8.1'
            mode: 644
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/motd':
            tag: 'CIS-8.1'
            mode: 644
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
        - '/etc/issue':
            tag: 'CIS-8.1'
            mode: 644
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
        - '/etc/issue.net':
            tag: 'CIS-8.1'
            mode: 644
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: 'Files containing the warning banners must be owned by root and must have permissions 644'
    alert: email
    trigger: state

  passwd_perm:
    data:
      'CentOS-6':
        - '/etc/passwd':
            tag: 'CIS-9.1.2'
            mode: 644
      'CentOS Linux-7':
        - '/etc/passwd':
            tag: 'CIS-9.1.2'
            mode: 644
    description: '/etc/passwd must have permissions 644'
    alert: email
    trigger: state

  passwd_own:
    data:
      'CentOS-6':
        - '/etc/passwd':
            tag: 'CIS-9.1.6'
            user: 'root'
            uid: 0
            group: 'root'
            uid: 0
      'CentOS Linux-7':
        - '/etc/passwd':
            tag: 'CIS-9.1.6'
            user: 'root'
            uid: 0
            group: 'root'
            uid: 0
    description: '/etc/passwd must be owned by root'
    alert: email
    trigger: state

  shadow_perm:
    data:
      'CentOS-6':
        - '/etc/shadow':
            tag: 'CIS-9.1.3'
            mode: 0
      'CentOS Linux-7':
        - '/etc/shadow':
            tag: 'CIS-9.1.3'
            mode: 0
    description: '/etc/shadow must have permissions 000'
    alert: email
    trigger: state

  shadow_own:
    data:
      'CentOS-6':
        - '/etc/shadow':
            tag: 'CIS-9.1.7'
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/shadow':
            tag: 'CIS-9.1.7'
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/shadow must be owned by root'
    alert: email
    trigger: state

  gshadow_perm:
    data:
      'CentOS-6':
        - '/etc/gshadow':
            tag: 'CIS-9.1.4'
            mode: 0
      'CentOS Linux-7':
        - '/etc/gshadow':
            tag: 'CIS-9.1.4'
            mode: 0
    description: '/etc/gshadow must have permissions 000'
    alert: email
    trigger: state

  gshadow_own:
    data:
      'CentOS-6':
        - '/etc/gshadow':
            tag: 'CIS-9.1.8'
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/gshadow':
            tag: 'CIS-9.1.8'
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/gshadow must be owned by root'
    alert: email
    trigger: state

  group_perm:
    data:
      'CentOS-6':
        - '/etc/group':
            tag: 'CIS-9.1.5'
            mode: 644
      'CentOS Linux-7':
        - '/etc/group':
            tag: 'CIS-9.1.5'
            mode: 644
    description: '/etc/group must have permissions 000'
    alert: email
    trigger: state

  group_own:
    data:
      'CentOS-6':
        - '/etc/group':
            tag: 'CIS-9.1.9'
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/group':
            tag: 'CIS-9.1.9'
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/group must be owned by root'
    alert: email
    trigger: state
