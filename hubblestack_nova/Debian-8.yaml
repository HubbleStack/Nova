grep:
  whitelist:

    local_only_mta:
      data:
        Debian-8:
          - '/etc/exim4/update-exim4.conf:
              tag: 'CIS-6.15'
              pattern: "^dc_local_interfaces = '127.0.0.1'"
      description: 'Configure Mail Transfer Agent for local-only mode (Scored)'

    fstab_tmp_partition:
      data:
        Debian-8:
          - '/etc/fstab':
              tag: 'CIS-2.1'
              pattern: '/tmp'
      description: 'Create Separate Partition for /tmp (Scored)'

    fstab_tmp_partition_nodev:
      data:
        Debian-8:
          - '/etc/fstab':
              tag: 'CIS-2.2'
              pattern: '/tmp'
              match_output: 'nodev'
      description: 'Set nodev option for /tmp Partition (Scored)'

    fstab_tmp_partition_nosuid:
      data:
        Debian-8:
          - '/etc/fstab':
              tag: 'CIS-2.3'
              pattern: '/tmp'
              match_output: 'nosuid'
      description: 'Set nosuid option for /tmp Partition (Scored)'

    fstab_tmp_partition_noexec:
      data:
        Debian-8:
          - '/etc/fstab':
              tag: 'CIS-2.4'
              pattern: '/tmp'
              match_output: 'nosuid'
      description: 'Set noexec option for /tmp Partition (Scored)'

    fstab_var_partition:
      data:
        Debian-8:
          - '/etc/fstab':
              tag: 'CIS-2.5'
              pattern: '/var'
      description: 'Create Separate Partition for /var (Scored)'

    fstab_var_tmp_bind_mount:
      data:
        Debian-8:
          - '/etc/fstab':
              tag: 'CIS-2.6'
              pattern: '/var'
              match_output: '/var/tmp'
      description: 'Bind Mount the /var/tmp directory to /tmp (Scored)'

    fstab_var_log_partition:
      data:
        Debian-8:
          - '/etc/fstab':
              tag: 'CIS-2.7'
              pattern: '/var/log'
      description: 'Create Separate Partition for /var/log (Scored)'

    fstab_var_log_audit_partition:
      data:
        Debian-8:
          - '/etc/fstab':
              tag: 'CIS-2.8'
              pattern: '/var/log/audit'
      description: 'Create Separate Partition for /var/log/audit (Scored)'

    fstab_home_partition:
      data:
        Debian-8:
          - '/etc/fstab':
              tag: 'CIS-2.9'
              pattern: '/home'
      description: 'Create Separate Partition for /home (Scored)'

    fstab_home_partition_nodev:
      data:
        Debian-8:
          - '/etc/fstab':
              tag: 'CIS-2.10'
              pattern: '/home'
              match_output: 'nodev'
      description: 'Add nodev Option to /home (Scored)'

    fstab_dev_shm_partition_nodev:
      data:
        Debian-8:
          - '/etc/fstab':
              tag: 'CIS-2.14'
              pattern: '/dev/shm'
              match_output: 'nodev'
      description: 'Add nodev Option to /dev/shm Partition (Scored)'

    fstab_dev_shm_partition_nosuid:
      data:
        Debian-8:
          - '/etc/fstab':
              tag: 'CIS-2.15'
              pattern: '/dev/shm'
              match_output: 'nosuid'
      description: 'Add nosuid Option to /dev/shm Partition (Scored)'

    fstab_dev_shm_partition_noexec:
      data:
        Debian-8:
          - '/etc/fstab':
              tag: 'CIS-2.16'
              pattern: '/dev/shm'
              match_output: 'noexec'
      description: 'Add noexec Option to /dev/shm Partition (Scored)'

    configure_ntp:
      data:
        Debian-8:
          - '/etc/ntp.conf':
              tag: 'CIS-6.5'
              pattern: 'restrict default'
      description: 'Configure Network Time Protocol (NTP) (Scored)'

stat:
  grub_conf_own:
    data:
      Debian-8:
        - '/boot/grub/grub.cfg':
            tag: 'CIS-3.1'
            user: 'root'
            group: 'root'
    description: 'Grub must be owned by root (Scored)'

  grub_conf_perm:
    data:
      Debian-8:
        - '/boot/grub/grub.cfg':
            tag: 'CIS-3.2'
            mode: 600
    description: 'Set permissions on bootloader config (Scored)'

    boot_loader_passwd:
      data:
        Debian-8:
          - '/boot/grub/grub.cfg':
              tag: 'CIS-3.3'
              pattern: "^password"
      description: 'Set Boot Loader Password (Scored)'

    restrict_core_dumps:
      data:
        Debian-8:
          - '/etc/security/limits.conf':
              tag: 'CIS-4.1'
              pattern: 'hard core'
      description: 'Restrict Core Dumps (Scored)'

  blacklist:
    single_user_auth:
      data:
        Debian-8:
          - '/etc/shadow':
              tag: 'CIS-3.4'
              pattern: "^root:[*\!]:"
      description: 'Require Authentication for Single-User Mode (Scored)'

sysctl:
  randomize_va_space:
    data:
      Debian-8:
        - 'kernel.randomize_va_space':
            tag: 'CIS-4.3'
            match_output: '2'
    description: 'Enable Randomized Virtual Memory Region Placement (Scored)'

  ip_forwarding:
    data:
      Debian-8:
        - 'net.ipv4.ip_forward':
            tag: 'CIS-7.1.1'
            match_output: '0'
    description: 'Disable IP Forwarding (Scored)'

  send_packet_redirect:
    data:
      Debian-8:
        - 'net.ipv4.conf.all.send_redirects'
            tag: 'CIS-7.1.2'
            match_output: '0'
        - 'net.ipv4.conf.default.send_redirects':
            tag: 'CIS-7.1.2'
            match_output: '0'
    description: 'Disable Send Packet Redirect (Scored)'

  source_routed_packet_acceptance:
    data:
      Debian-8:
        - 'net.ipv4.conf.all.accept_source_route':
            tag: 'CIS-7.2.1'
            match_output: '0'
        - 'net.ipv4.conf.default.accept_source_route':
            tag: 'CIS-7.2.1'
            match_output: '0'
    description: 'Disable Source Routed Packet Acceptance (Scored)'

  icmp_redirect_acceptance:
    data:
      Debian-8:
        - 'net.ipv4.conf.all.accept_redirects':
            tag: 'CIS-7.2.2'
            match_output: '0'
        - 'net.ipv4.conf.default.accept_redirects':
            tag: 'CIS-7.2.2'
            match_output: '0'
    description: 'Disable ICMP Redirect Acceptance'

  icmp_redirect_acceptance:
    data:
      Debian-8:
        - 'net.ipv4.conf.all.secure_redirects':
            tag: 'CIS-7.2.3'
            match_output: '0'
        - 'net.ipv4.conf.default.secure_redirects':
            tag: 'CIS-7.2.3'
            match_output: '0'
    description: 'Disable Secure ICMP Redirect Acceptance'

  log_suspicious_packets:
    data:
      Debian-8:
        - 'net.ipv4.conf.all.log_martian':
            tag: 'CIS-7.2.4'
            match_output: '1'
        - 'net.ipv4.conf.default.log_martians':
            tag: 'CIS-7.2.4'
            match_output: '1'
    description: 'Log Suspicious Activity (Scored)'

  ignore_broadcast_requests:
    data:
      Debian-8:
        - 'net.ipv4.icmp_echo_ignore_broadcasts':
            tag: 'CIS-7.2.5'
            match_output: '1'
    description: 'Enable Ignore Broadcast Requests (Scored)'

  bad_error_message_protection:
    data:
      Debian-8:
        - 'net.ipv4.icmp_ignore_bogus_error_responses':
            tag: 'CIS-7.2.6'
            match_output: '1'
    description: 'Enable Bad Error Message Protection (Scored)'

  source_route_validation:
    data:
      Debian-8:
        - 'net.ipv4.conf.all.rp_filter':
            tag: 'CIS-7.2.7'
            match_output: '1'
        - 'net.ipv4.conf.default.rp_filter'
            tag: 'CIS-7.2.7'
            match_output: '1'

  tcp_syn_cookies:
    data:
      Debian-8:
        - 'net.ipv4.tcp_syncookies':
            tag: 'CIS-7.2.8'
            match_output: '1'
    description: 'Enable TCP SYN cookies (Scored)'

pkg:
  blacklist:

    prelink:
      data:
        Debian-8:
          - 'prelink': 'CIS-4.4'
      description: 'Disable Prelink (Scored)'

    nis:
      data:
        Debian-8:
          - 'nis': 'CIS-5.1.1'
      description: 'Remove nis client and nis server (Scored)'

    rsh:
      data:
        Debian-8:
          - 'rsh-server': 'CIS-5.1.2'
          - 'rsh-client': 'CIS-5.1.3'
          - 'rsh-redone-client': 'CIS-5.1.3'
      description: 'Remove rsh and rsh-server (Scored)'

    talk:
      data:
        Debian-8:
          - 'talk': 'CIS-5.1.5'
      description: 'Remove talk and talk-server (Scored)'

    telnet:
      data:
        Debian-8:
          - 'telnet': 'CIS-5.1.6'
          - 'telnet-server': 'CIS-5.1.6'
      description: 'Remove telnet and telnet-server (Scored)'

    tftp:
      data:
        Debian-8:
          - 'tftp': 'CIS-5.1.7'
          - 'atftp': 'CIS-5.1.7'
      description: 'Remove tftp and tftp-server (Scored)'

    xinetd:
      data:
        Debian-8:
          - 'xinetd': 'CIS-5.1.8'
      description: 'Remove xinetd (Scored)'

    xorg-server:
      data:
        Debian-8:
          - 'xserver-xorg-core': 'CIS-6.1'
      description: 'Remove the X Window System (Scored)'

    avahi-daemon:
      data:
        Debian-8:
          - 'avahi-daemon': 'CIS-6.2'
      description: 'Disable Avahi Server (Scored)'

    dhcp:
      data:
        Debian-8:
          - 'isc-dhcp-server': 'CIS-6.4'
      description: 'Remove DHCP server (Scored)'

    slapd:
      data:
        Debian-8:
          - 'slapd': 'CIS-6.6'
      description: 'Ensure LDAP is not enabled (Scored)'

  whitelist:

    apparmor:
      data:
        Debian-8:
          - 'apparmor': 'CIS-4.5'
          - 'apparmor-utils': 'CIS-4.5'
          - 'apparmor-profiles': 'CIS-4.5'
      description: 'Activate AppArmor (Scored)'

    tcp_wrappers:
      data:
        Debian-8:
          - 'tcpd': 'CIS-7.4.1'
      description: 'Install TCP Wrappers (Scored)'
